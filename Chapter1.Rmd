# 1 なぜ統計的因果推論が必要か  
私たちが研究を行う上で立てるリサーチクエスチョンの多くは、「ニホンザルの群れの凝集性はオスの攻撃に<u>影響を受けるのか</u>」、「食物状況はオスの性行動に<u>影響しているか</u>」というようなものである。これらの問いは、2つ(あるいはそれ以上)の変数間の**相関関係**(「$X$が小さい/大きいほど、$Y$も小さい/大きい」)ではなく、**因果関係**(「$X$を小さく/大きく<u>すると</u>、$Y$も小さく/大きく<u>なる</u>」)に関する問いである。すなわち、私たちの研究の多くは、データから変数間の因果関係(およびその効果量)を推測する(= **統計的因果推論**)ことがゴールにある。よって、どのようにすれば因果推論を行うことができるかを学ぶことは、私たちの研究の根本にかかわる重要なことだと考えられる。    

**統計的因果推論**についての知識がなければ、実際に得られたデータから因果関係を推測することは難しい。特に研究者が変数への操作や介入を行えない観察研究では、複数の要因が複雑に影響し合っていることが珍しくないため、殊更に困難である。そのような状況では、変数間でみられる**相関関係が実際の因果関係と一致しない**ことが良く起こるからである。  


以下の例を考えてみよう。  
ニホンザルのコドモにおいて、ある期間に食べた1日当たりの**平均食物摂取量**(乾燥重量で$X$g)がその期間における**遊び時間割合**($Y$%)に影響しているかを調べたいとする。$X$と$Y$、そして**年齢**($Z$)の間に図\@ref(fig:fig-graph)の間のような因果関係があるとする(もちろん架空の関係である)。なお、丸は各変数を、矢印は因果関係を表す(詳細は次章を参照)。    

```{r fig-graph, echo = FALSE, fig.dim = c(2.1,2.1), fig.cap = "X, Y, Zの間の因果関係"}
dagify(X ~ Z,
       Y ~ Z,
       Y ~ X,
       coords = tibble(name = c("X","Z","Y"),
                       x = c(1,2,3),
                       y = c(1,1.3,1))) %>% 
  ggdag(node_size =10, text_size = 3)+
  geom_text(data = tibble(x = c(1.4,2,2.65),y =c(1.15,1.015,1.15),label = c("+","+","－"),
                          xend = c(1.4,2,2.65), yend = c(1.15,1.015,1.15), size = 1.5),
            aes(label = label))+
  theme_dag()
```

このような関係の下ではどのようなデータが得られるだろうか。シミュレーションによって図\@ref(fig:fig-graph)のような因果関係を持つデータを生成し(詳細はRのコードを参照)、$X$と$Y$の関係を散布図にしたものが、図\@ref(fig:fig-example)である。  
この図からは「食物摂取量($X$)が多いほど、遊び時間割合($Y$)が**少ない**」という負の相関関係が読み取れる。この関係は、「食物摂取量($X$)が多くなると、遊び時間割合($Y$)が**多くなる**」という実際の因果関係(図\@ref(fig:fig-graph)参照)とは正負が逆になってしまっている。つまり、$X$と$Y$の相関関係だけを見るだけでは、その因果関係を適切に推測できないのである。  

```{r fig-example, echo = FALSE, fig.cap = "平均食物摂取量(X)と遊び時間割合(Y)の関係。直線は回帰直線を表す。", fig.dim = c(3.2,3.2)}
set.seed(123)
## データ数
N <- 48
## 年齢
Z <- rep(1:4, each = N/4) 
## 食物量  
X <- rnorm(N, 120 + 20*Z, 10)
## 5遊び時間割合  
Y <- rnorm(N, 25 -10*Z + 0.2*X , 5)

d <- tibble(X=X,Y=Y,Z=Z)

## 図
d %>% 
  ggplot(aes(x=X, y=Y))+
  geom_point(alpha = 0.7, size = 1.3)+
  geom_smooth(method = "lm",
              se = F,
              size = 1.2,
              color = "grey60")+
  theme_bw(base_size = 10)+
  theme(aspect.ratio = 0.8)
```

なぜこのようなことが起こるのだろうか。それは、$X$と$Y$の因果関係を適切に推測するためには、その両方に影響している第3の変数$Z$(**年齢**)を考慮しなくてはならないからである。年齢ごとに$X$と$Y$の関係を見てみると、実際の因果関係と一致した方向の正の相関(「$X$が多いほど$Y$も多い」)が確認できるようになる。  

```{r fig-example2, echo = FALSE, fig.cap = "年齢(Z)を考慮した平均食物摂取量(X)と遊び時間割合(Y)の関係。直線は年齢ごとの回帰直線を表す。", fig.dim = c(4,3.2)}
d %>% 
  ggplot(aes(x=X, y=Y, color = as.factor(Z)))+
  geom_point(alpha = 0.7, size = 1.3)+
  geom_smooth(method = "lm",
              se = F,
              size = 0.8)+
  labs(color = "年齢(Z)")+
  scale_color_nejm()+
  theme_bw(base_size = 10)+
  theme(aspect.ratio = 0.8)
```

このように、データの背後にある変数間の**因果構造**(= データ生成過程)を考慮しなければ、データから適切な因果推論を行うことはできない。  
この後見ていくように、データの因果構造によってどのような変数を考慮すべきかは異なってくる。本稿では、**構造的因果モデル(SCM)**と**因果ダイアグラム**という2つのツールを用いることで、いかなる因果構造を持つデータについても適切に因果推論を行う手法を学んでいく。  

学ぶのは主に以下の3点についてである。  

- 因果関係を正確に記述する方法(第2章)  
- 因果モデルの構造をデータの特徴に関連付ける方法(第3章)  
- モデルとデータに含まれる因果関係の組み合わせから結論を導く方法(第4~5章)  